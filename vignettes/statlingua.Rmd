---
title: "statlingua"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{statlingua}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(statlingua)
```


## Example: inappropriate use of two-sample t-test

The following example is taken from a [tutorial on paired t-tests](https://www.jmp.com/en/statistics-knowledge-portal/t-test/paired-t-test). Here we use an independent two-sample t-test to (inappropriately) analyze paired data.

```{r ex-t-test}
context <- "
An instructor wants to use two exams in her classes next year. This year, she gives both exams to the students. She wants to know if the exams are equally difficult and wants to check this by comparing the two sets of scores. Here is the data:

 student exam_1_score exam_2_score
     Bob           63           69
    Nina           65           65
     Tim           56           62
    Kate          100           91
  Alonzo           88           78
    Jose           83           87
  Nikhil           77           79
   Julia           92           88
   Tohru           90           85
 Michael           84           92
    Jean           68           69
   Indra           74           81
   Susan           87           84
   Allen           64           75
    Paul           71           84
  Edwina           88           82
"

# Create the data set
exam_scores <- tibble::tribble(
  ~student,  ~exam_1_score, ~exam_2_score,
  "Bob",     63,            69,
  "Nina",    65,            65,
  "Tim",     56,            62,
  "Kate",    100,           91,
  "Alonzo",  88,            78,
  "Jose",    83,            87,
  "Nikhil",  77,            79,
  "Julia",   92,            88,
  "Tohru",   90,            85,
  "Michael", 84,            92,
  "Jean",    68,            69,
  "Indra",   74,            81,
  "Susan",   87,            84,
  "Allen",   64,            75,
  "Paul",    71,            84,
  "Edwina",  88,            82
)

# Run a two-sample t-test
(tt <- t.test(exam_scores$exam_1_score, y = exam_scores$exam_2_score))
```

Next, we initialize a call the `explain()` method to explain the output from the statistical test.

```{r ex-t-test-explain, cache=TRUE, results="asis"}
# Explain the output
chat <- ellmer::chat_gemini(echo = "none")
ex <- explain(tt, chat = chat, context = context) 
cat(ex)
```


## Example: polynomial regression

The following example fits a quadradic linear model to the built-in `cars` data set.

```{r ex-lm-polynomial}
# Polynomial regression
cars_lm <- lm(dist ~ poly(speed, degree = 2), data = cars)
summary(cars_lm)
```

```{r ex-lm-polynomial-explain, cache=TRUE, results="asis"}
context <- "
The data give the speed of cars (mph) and the distances taken to stop (ft).
Note that the data were recorded in the 1920s.
"
chat <- ellmer::chat_gemini(echo = "none")
ex <- explain(cars_lm, chat = chat, context = context)
cat(ex)
```


## Example: Poisson regression

The following example uses the generic function `explain()` to explain the output from a fitted [Poisson GLM](https://en.wikipedia.org/wiki/Poisson_regression) using simple Markdown syntax:

```{r ex-glm-poisson}
# Poisson regression example from ?stats::glm
counts <- c(18,17,15,20,10,20,25,13,12)
outcome <- gl(3,1,9)
treatment <- gl(3,3)
summary(D93_glm <- glm(counts ~ outcome + treatment, family = poisson()))
```

```{r ex-glm-poisson-explain, cache=TRUE, results="asis"}
chat <- ellmer::chat_gemini(echo = "none")
ex <- explain(D93_glm, chat = chat) 
cat(ex)
```
